# DoD - CI 优化：删除 Nightly workflow 和提升性能

QA: docs/QA-DECISION.md

## 验收标准

### 功能验收
- [ ] nightly.yml 文件已删除
      Test: manual:确认 .github/workflows/nightly.yml 文件不存在
- [ ] ci.yml 的快速检查改为并行执行
      Test: manual:检查 ci.yml 中 version-check, known-failures-protection, config-audit, impact-check, contract-drift-check 使用 matrix strategy 并行
- [ ] 创建了 setup-project composite action
      Test: manual:确认 .github/actions/setup-project/action.yml 存在且包含 setup-node 和 npm ci 步骤
- [ ] ci.yml 中使用了 setup-project action
      Test: manual:确认 ci.yml 多个 jobs 使用 `uses: ./.github/actions/setup-project` 替代重复代码
- [ ] regression-contract.yaml 移除 Nightly trigger
      Test: manual:检查 regression-contract.yaml 中不再有 `trigger: [Nightly]` 配置
- [ ] CI 运行时间减少约 5 分钟（从 PRD 要求）
      Test: manual:对比优化前后的 CI 总运行时间（baseline: 最近 PR workflow run #21627475457 为 74 秒），预期优化后减少 50-60 秒（通过并行化快速检查）
- [ ] 并行执行的 5 个快速检查独立运行成功
      Test: manual:确认 version-check, known-failures-protection, config-audit, impact-check, contract-drift-check 在 matrix 中各自独立完成且全部成功
- [ ] setup-project action 在所有使用它的 job 中正常工作
      Test: manual:检查 ci.yml 中所有使用 setup-project action 的 jobs 都成功完成 setup 步骤（Node.js 安装、依赖安装）

### 测试验收
- [ ] npm run qa 通过
      Test: contract:C2-001
- [ ] CI 通过，无新增失败
      Test: manual:等待 GitHub Actions CI 运行完成，所有 checks 绿色
- [ ] 验证 CI 结构完整性
      Test: manual:确认优化后的 CI 行为与优化前一致（除了性能提升），无功能退化
