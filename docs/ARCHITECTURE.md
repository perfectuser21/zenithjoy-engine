# 知识分层架构

> 唯一真实源：本文件定义经验和知识应该记录在哪里

---

## 分层结构

```
┌─────────────────────────────────────────────────────────┐
│                 全局层 (~/.claude/CLAUDE.md)            │
│           跨项目通用规则、个人习惯、全局配置             │
└─────────────────────────────────────────────────────────┘
                           │
          ┌────────────────┼────────────────┐
          ▼                ▼                ▼
┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐
│ zenithjoy-engine│ │   项目 A        │ │   项目 B        │
│                 │ │                 │ │                 │
│ CLAUDE.md:      │ │ CLAUDE.md:      │ │ CLAUDE.md:      │
│ - 项目入口      │ │ - 项目入口      │ │ - 项目入口      │
│ - 指向详细文档  │ │ - 指向详细文档  │ │ - 指向详细文档  │
│                 │ │                 │ │                 │
│ docs/:          │ │ docs/:          │ │ docs/:          │
│ - LEARNINGS.md  │ │ - 项目经验      │ │ - 项目经验      │
│ - ARCHITECTURE.md││                 │ │                 │
│                 │ │                 │ │                 │
│ CHANGELOG.md    │ │                 │ │                 │
└─────────────────┘ └─────────────────┘ └─────────────────┘
                           │
                           ▼
                  ┌─────────────────┐
                  │ Notion (可选)   │
                  │ - 长期知识库    │
                  │ - 会话摘要      │
                  └─────────────────┘
```

---

## 记录规则

| 类型 | 记录位置 | 说明 |
|------|----------|------|
| Engine bug | GitHub Issues | 可追踪、可关闭 |
| Engine 开发经验 | `docs/LEARNINGS.md` | 踩的坑、学到的 |
| Engine 架构决策 | `docs/ARCHITECTURE.md` | 本文件 |
| 版本记录 | `CHANGELOG.md` | 版本更新、PR 摘要 |
| 项目特定规则 | 项目的 `CLAUDE.md` | 简洁入口 |
| 项目开发经验 | 项目的 `docs/` | 详细记录 |
| 跨项目通用经验 | `~/.claude/CLAUDE.md` | 全局规则 |
| 长期知识库 | Notion（可选） | 会话摘要、搜索 |

---

## 文档职责

### CLAUDE.md（每个项目）
- **职责**：项目入口，告诉 Claude 这是什么项目
- **内容**：简洁的项目说明 + 指向详细文档的链接
- **原则**：不超过 100 行，只放核心规则

### docs/（每个项目）
- **职责**：详细文档存放地
- **内容**：
  - `LEARNINGS.md` - 开发经验
  - `ARCHITECTURE.md` - 架构决策
  - 其他专题文档

### ~/.claude/CLAUDE.md（全局）
- **职责**：跨项目通用规则
- **内容**：个人习惯、全局配置、通用禁止项

---

## 自动化

`/dev` 流程的 Step 7 (Learn) 会询问本次开发学到什么：

1. **Engine 相关** → 追加到 `docs/LEARNINGS.md`
2. **项目相关** → 追加到项目的 docs/
3. **通用经验** → 追加到 `~/.claude/CLAUDE.md`
4. **长期保存** → 同步到 Notion
