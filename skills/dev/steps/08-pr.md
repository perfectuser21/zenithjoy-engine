# Step 8: æäº¤ PR

> ç‰ˆæœ¬å· + commit + push + PR
> **åˆ›å»º PR åç»§ç»­ Step 9 ç­‰å¾… CIï¼ŒStop Hook æ§åˆ¶å®Œæˆæ¡ä»¶**

---

## 8.1 ä¼šè¯æ¢å¤æ£€æµ‹

**å…ˆæ£€æµ‹æ˜¯å¦æ˜¯æ¢å¤çš„ä¼šè¯**ï¼š

```bash
EXISTING_PR=$(gh pr list --head "$BRANCH_NAME" --state all --json number,url,state -q '.[0]' 2>/dev/null)

if [ ! -z "$EXISTING_PR" ]; then
  PR_STATE=$(echo "$EXISTING_PR" | jq -r '.state')

  if [ "$PR_STATE" = "MERGED" ]; then
    echo "âœ… PR å·²åˆå¹¶ï¼Œè·³åˆ° cleanup"
  elif [ "$PR_STATE" = "OPEN" ]; then
    echo "âœ… PR å·²å­˜åœ¨ï¼Œè·³åˆ° CI"
  fi
fi
```

---

## 8.2 ç‰ˆæœ¬å·æ›´æ–°

**æ£€æµ‹æ˜¯å¦ä¸ºæµ‹è¯•ä»»åŠ¡**ï¼š

```bash
IS_TEST=$(git config branch."$BRANCH_NAME".is-test 2>/dev/null)

if [ "$IS_TEST" = "true" ]; then
    echo "ğŸ§ª æµ‹è¯•ä»»åŠ¡ï¼šè·³è¿‡ CHANGELOG å’Œç‰ˆæœ¬å·æ›´æ–°"
    # ä¸æ›´æ–° package.json å’Œ CHANGELOG.md
else
    # æ­£å¸¸æ›´æ–°ç‰ˆæœ¬å·
fi
```

**æ­£å¸¸ä»»åŠ¡ï¼šæäº¤å‰å¿…é¡»æ›´æ–°ç‰ˆæœ¬å·ï¼ˆsemverï¼‰**ï¼š

| commit ç±»å‹ | ç‰ˆæœ¬å˜åŒ– |
|-------------|----------|
| fix: | patch (+0.0.1) |
| feat: | minor (+0.1.0) |
| feat!: / BREAKING: | major (+1.0.0) |

**ç‰ˆæœ¬å·å˜åŒ–ç¤ºä¾‹**ï¼š

| å½“å‰ç‰ˆæœ¬ | commit ç±»å‹ | æ–°ç‰ˆæœ¬ |
|---------|-------------|--------|
| 8.16.0 | fix: | 8.16.1 |
| 8.16.1 | feat: | 8.17.0 |
| 8.17.0 | feat!: | 9.0.0 |

æ›´æ–° `package.json` å’Œ `CHANGELOG.md`ã€‚

**æµ‹è¯•ä»»åŠ¡**ï¼šè·³è¿‡ç‰ˆæœ¬å·å’Œ CHANGELOG æ›´æ–°ï¼Œcommit æ¶ˆæ¯ä½¿ç”¨ `test:` å‰ç¼€ã€‚

---

## 8.3 Squash Evidence Commitï¼ˆæ–°å¢ï¼‰

**åœ¨æäº¤å‰ï¼Œæ£€æŸ¥å¹¶åˆå¹¶ evidence commit**ï¼š

```bash
# å¦‚æœæœ€åä¸€ä¸ª commit æ˜¯ evidence commitï¼Œè‡ªåŠ¨åˆå¹¶åˆ°ä»£ç  commit
bash scripts/squash-evidence.sh
```

**è¯´æ˜**ï¼š
- é¿å… SHA ä¸åŒ¹é…é—®é¢˜
- ä¿æŒå¹²å‡€çš„ commit å†å²
- æœ€ç»ˆåªæœ‰ä¸€ä¸ª commitï¼ˆä»£ç  + evidenceï¼‰

---

## 8.4 æäº¤

```bash
git add -A
git commit -m "feat: <åŠŸèƒ½æè¿°>

Co-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>"
```

**æ³¨æ„**ï¼š
- å¦‚æœ Step 7 å·²ç»æš‚å­˜äº† evidenceï¼Œè¿™é‡Œä¼šä¸€æ¬¡æ€§æäº¤
- å¦‚æœæ²¡æœ‰æš‚å­˜ evidenceï¼Œè¿™é‡Œä¼šåŒ…å«æ‰€æœ‰å˜æ›´

---

## 8.5 æ¨é€

```bash
/usr/bin/git push -u origin HEAD
```

---

## 8.5 åˆ›å»º PR

```bash
gh pr create --base develop --title "feat: <åŠŸèƒ½æè¿°>" --body "## Summary
- <ä¸»è¦æ”¹åŠ¨>

## Test
- [x] æœ¬åœ°æµ‹è¯•é€šè¿‡

---
Generated by /dev workflow"
```

---

## 8.6 å®Œæˆå

**PR åˆ›å»ºåï¼Œç«‹å³ç»§ç»­ Step 9 ç­‰å¾… CI å¹¶åˆå¹¶**ã€‚

Stop Hook å®Œæˆæ¡ä»¶ï¼š
1. PR å·²åˆ›å»º âœ…ï¼ˆåˆšåˆ›å»ºï¼‰
2. CI é€šè¿‡ï¼Ÿâ†’ Step 9 æ£€æŸ¥
3. PR å·²åˆå¹¶ï¼Ÿâ†’ Step 9 æ‰§è¡Œ

**ä¸è¦åœ¨ PR åˆ›å»ºååœæ­¢**ï¼Œç»§ç»­æ‰§è¡Œ Step 9ã€‚
