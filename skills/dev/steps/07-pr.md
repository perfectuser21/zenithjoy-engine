# Step 7: 提交 PR

> 版本号 + commit + push + PR

**前置条件**：step >= 6（本地测试通过）
**完成后设置状态**：
```bash
git config branch."$BRANCH_NAME".step 7
```

---

## 7.1 会话恢复检测

**先检测是否是恢复的会话**：

```bash
EXISTING_PR=$(gh pr list --head "$BRANCH_NAME" --state all --json number,url,state -q '.[0]' 2>/dev/null)

if [ ! -z "$EXISTING_PR" ]; then
  PR_STATE=$(echo "$EXISTING_PR" | jq -r '.state')

  if [ "$PR_STATE" = "MERGED" ]; then
    echo "✅ PR 已合并，跳到 cleanup"
  elif [ "$PR_STATE" = "OPEN" ]; then
    echo "✅ PR 已存在，跳到质检"
  fi
fi
```

---

## 7.2 版本号更新

**提交前必须更新版本号（semver）**：

| commit 类型 | 版本变化 |
|-------------|----------|
| fix: | patch (+0.0.1) |
| feat: | minor (+0.1.0) |
| feat!: / BREAKING: | major (+1.0.0) |

更新 `package.json` 和 `CHANGELOG.md`。

---

## 7.3 提交

```bash
git add -A
git commit -m "feat: <功能描述>

Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>"
```

---

## 7.4 推送

```bash
/usr/bin/git push -u origin HEAD
```

---

## 7.5 创建 PR

```bash
gh pr create --base develop --title "feat: <功能描述>" --body "## Summary
- <主要改动>

## Test
- [x] 本地测试通过

---
Generated by /dev workflow"
```
