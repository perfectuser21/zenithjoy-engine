---
id: prd-phase6-skill-orchestration
version: 1.0.0
created: 2026-01-22
updated: 2026-01-22
changelog:
  - 1.0.0: 初始版本
---

# PRD: Phase 6 - Skill 编排闭环

## 背景

当前 /qa 和 /audit skills 是"孤岛文档"：
- 目录存在，但没有接入 /dev 主流程
- /dev 直接跑 `npm run qa`，没有调用 /qa 做测试决策
- 没有调用 /audit 做代码审计
- Skills 之间没有协作，没有产物留痕

## 功能描述

**让 /dev 成为编排者，在关键节点调用 /qa 和 /audit，输出固定产物**

### 核心改动

1. **DoD 前调用 /qa** → 输出 `docs/QA-DECISION.md`
   - 测试策略决策（auto/manual）
   - RCI 新增/更新决策
   - DoD 必须引用此决策

2. **测试前调用 /audit** → 输出 `docs/AUDIT-REPORT.md`
   - L1/L2 审计结论
   - blocker > 0 则停止
   - Decision: PASS/FAIL

3. **PR Gate 检查产物**
   - QA-DECISION.md 存在
   - AUDIT-REPORT.md 存在且 Decision: PASS
   - .dod.md 引用 QA 决策

## 成功标准

1. `steps/04-dod.md` 包含调用 /qa 的步骤
2. `steps/07-quality.md` 包含调用 /audit 的步骤
3. `pr-gate-v2.sh` 检查两个产物
4. 模板文件 `templates/QA-DECISION.md` 和 `templates/AUDIT-REPORT.md` 存在
5. npm run qa 通过

## 交付物

### 新增文件
- `templates/QA-DECISION.md` - QA 决策模板
- `templates/AUDIT-REPORT.md` - 审计报告模板

### 修改文件
- `skills/dev/steps/04-dod.md` - 加入 /qa 调用
- `skills/dev/steps/07-quality.md` - 加入 /audit 调用
- `hooks/pr-gate-v2.sh` - 检查产物

## 不做

- 修改 /qa 和 /audit 的核心逻辑
- 增加新的 skill
- 自动化生成产物（产物由 Claude 在执行 skill 时生成）
