---
id: prd-clear-v9-deep
version: 1.0.0
created: 2026-01-23
updated: 2026-01-23
changelog:
  - 1.0.0: 初始版本
---

# PRD - v9.0.0 深度扫描遗漏修复

Priority: P1

## 目标

修复 v9.0.0 发布后深度扫描发现的遗漏问题。

## 背景

v9.0.0 发布后，用户要求深度扫描 `|| true` 和 `2>/dev/null` 模式：
- 31 个 `|| true` 用法
- 150 个 `2>/dev/null` 用法

经过分析，大部分用法是合理的（有 else 分支处理错误），只发现 1 个真正问题。

## 问题清单

### install-hooks.sh:175 (L2)

**问题**: cp 失败时仍显示 OK
```bash
cp -r "$skill_dir"* "$target_skill/" 2>/dev/null || true
echo -e "  ${GREEN}[OK]${NC} $skill_name/"
```

**修复**: 检查 cp 结果，失败时显示警告
```bash
if cp -r "$skill_dir"* "$target_skill/" 2>/dev/null; then
    echo -e "  ${GREEN}[OK]${NC} $skill_name/"
else
    echo -e "  ${YELLOW}[WARN]${NC} $skill_name/ (部分文件可能未复制)"
fi
```

## 成功标准

- 1 个问题修复
- npm run qa 通过
- bash -n 语法检查通过
