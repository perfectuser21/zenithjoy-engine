# PRD - Revert 错误的 P1 轮询实现

## 需求来源

PR #263 的实现违背了两阶段分离原则，需要回退。

## 问题分析

### 当前实现的错误

PR #263 在 **一个会话内** 完成了 P0 和 P1：

```
❌ 错误流程（一个会话）:
Step 8: 创建 PR → 直接调用 Step 9 → 进入轮询循环 → 修复 → 合并
```

**后果**：
- Stop Hook 没有机会在 PR 创建后触发 `exit 0`
- 无法实现两阶段分离
- 与设计文档描述不符

### 正确设计

应该是 **两次会话**：

```
✅ 正确流程:

【会话 1 - P0 阶段】
/dev → PRD → 代码 → 质检 → PR 创建
    ↓
Stop Hook 检查: PR 已创建 → exit 0 ✅ 结束会话

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【会话 2 - P1 阶段】（用户问 或 自动唤醒）
阶段检测 → 发现 PR + CI fail → PHASE: p1
    ↓
进入轮询循环:
  while CI 运行中; do sleep 30; done
  CI fail → 修复 → push → 继续轮询
  CI success → 合并 → 结束
```

## 解决方案

1. Revert PR #263
2. 恢复到事件驱动模式
3. 后续重新设计实现正确的两阶段分离

## 涉及文件

Revert 会还原：
- skills/dev/steps/08-pr.md
- skills/dev/steps/09-ci.md
- skills/dev/SKILL.md
- package.json (10.4.0 → 10.3.0)
- CHANGELOG.md
- regression-contract.yaml
- features/feature-registry.yml
- hook-core/VERSION

## 成功标准

- [ ] Revert commit 已创建
- [ ] PR 创建并合并到 develop
- [ ] 恢复到事件驱动模式
- [ ] 为重新设计铺平道路
