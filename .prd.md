# PRD - 修复剩余中低优先级 Bug

**需求来源**: 深度扫描发现的 7 个中低优先级 bug

## Bug 列表

### MEDIUM 优先级

**#3 - check.sh 全局 SKILL.md 路径假设** (行 94-99)
- 问题：硬编码 `$HOME/.claude/skills/dev/SKILL.md` 路径
- 修复：检查本地和全局两个位置，或删除无用检查

**#5 - cleanup.sh set -e 与错误抑制冲突** (行 8)
- 问题：`set -euo pipefail` 可能导致网络问题时意外退出
- 修复：关键操作添加显式错误处理

**#6 - cleanup.sh 报告生成失败无日志** (行 40-48)
- 问题：`2>/dev/null` 吞掉错误信息
- 修复：记录错误到日志文件

**#8 - pr-gate-v2.sh --repo 解析不够健壮** (行 43, 50)
- 问题：特殊字符或 URL 格式可能解析失败
- 修复：增强正则表达式，支持更多格式

### LOW 优先级

**#4 - check.sh 过时注释** (行 209)
- 问题：提到已删除的 "step 状态机"
- 修复：更新注释

**#9 - VALIDATION.md 过时步骤引用**
- 问题：Step 8 描述错误
- 修复：更新文档

**#12 - generate-report.sh 空文件列表导致无效 JSON** (行 152)
- 问题：FILES_CHANGED 为空时生成无效 JSON
- 修复：添加空数组处理

## 成功标准

- [ ] check.sh 路径检查更灵活或移除
- [ ] cleanup.sh 错误处理改进
- [ ] pr-gate-v2.sh --repo 解析更健壮
- [ ] 过时注释和文档已更新
- [ ] generate-report.sh 空文件处理正确
- [ ] npm run qa 通过
